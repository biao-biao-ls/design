# ğŸ“ KNZN è®¤è¯ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

**é¡¹ç›®åç§°**: KNZN ç¡¬ä»¶å­¦ä¹ ç½‘ç«™ - è®¤è¯ç³»ç»Ÿ  
**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**æœ€åæ›´æ–°**: 2024-12-22  
**å®¡æ ¸çŠ¶æ€**: âœ… æœ€ç»ˆç¡®å®šç‰ˆæœ¬  
**æ–‡æ¡£ç±»å‹**: å®Œæ•´è®¾è®¡è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒå®šä½

**ä»"èŒä¸šèµ„æ ¼è®¤è¯"å®šä½ä¸º"å­¦ä¹ æˆå°±è¯æ˜"**

æˆ‘ä»¬è¯æ˜çš„æ˜¯"ä»–å­¦å®Œäº†è¿™é—¨è¯¾"ï¼Œè€Œä¸æ˜¯"ä»–æœ‰èµ„æ ¼ä¿®æ ¸ç”µç«™"ã€‚

### è®¤è¯æ€§è´¨
- **å­¦ä¹ è¯ä¹¦**ï¼ˆCompletion Certificateï¼‰è€ŒéèŒä¸šèµ„æ ¼
- **æˆå°±å±•ç¤º**è€Œéèƒ½åŠ›è®¤å®š
- **å­¦ä¹ æ¿€åŠ±**è€Œéå°±ä¸šå‡­è¯

## ğŸ—ï¸ è®¤è¯ä½“ç³»

### è®¤è¯æ–¹å¼ï¼ˆ2 ç§ï¼‰

```
ğŸ¤– è‡ªåŠ¨è®¤è¯
â”œâ”€ å®Œæˆæ‰€æœ‰å…³å¡ = è·å¾—"ç†è®ºå¾½ç« "
â”œâ”€ ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥å­¦ä¹ è¿›åº¦
â””â”€ å³æ—¶é¢å‘ï¼Œæ— éœ€ç­‰å¾…

ğŸ‘¥ ç¤¾äº¤è®¤è¯  
â”œâ”€ é«˜éš¾åº¦ä»¿çœŸæŒ‘æˆ˜é€šè¿‡
â”œâ”€ æˆ–ä¸Šä¼ å®ç‰©è¿è¡Œè§†é¢‘åˆ°ç¤¾åŒºï¼ˆå¯é€‰åŠ åˆ†é¡¹ï¼‰
â”œâ”€ ç¤¾åŒºè¯„å®¡å›¢é¢„ç­›é€‰ + ç®€å•äººå·¥å®¡æ ¸
â””â”€ æˆ–ç¤¾åŒºé«˜èµè‡ªåŠ¨è§¦å‘ï¼ˆ50+ èµï¼‰
```

### è®¤è¯ç­‰çº§ï¼ˆ2 çº§ï¼‰

```
â­ ç†è®ºè®¤è¯ (Theory Badge)
â€¢ å®Œæˆæ‰€æœ‰ç›¸å…³è¯¾ç¨‹å’Œå…³å¡
â€¢ ç³»ç»Ÿè‡ªåŠ¨é¢å‘
â€¢ è¯æ˜ï¼šæŒæ¡äº†ç†è®ºçŸ¥è¯†

â­â­ å®æˆ˜è®¤è¯ (Practice Badge)  
â€¢ ç†è®ºè®¤è¯ + é«˜éš¾åº¦ä»¿çœŸæŒ‘æˆ˜é€šè¿‡
â€¢ æˆ–ç†è®ºè®¤è¯ + ä¸Šä¼ å®ç‰©è§†é¢‘ï¼ˆåŠ åˆ†é¡¹ï¼‰
â€¢ ç¤¾åŒºè¯„å®¡å›¢å®¡æ ¸é€šè¿‡
â€¢ è¯æ˜ï¼šèƒ½å¤Ÿå®é™…åº”ç”¨å’Œè§£å†³å¤æ‚é—®é¢˜
```

### å¾½ç« åº“ï¼ˆ8 ä¸ªæ ¸å¿ƒå¾½ç« ï¼‰

```
æŠ€èƒ½ç±»ï¼š
ğŸ”§ Arduino å…¥é—¨    [å®Œæˆ Arduino åŸºç¡€å…³å¡]
ğŸ”§ PCB è®¾è®¡å…¥é—¨    [å®Œæˆ PCB è®¾è®¡å…³å¡] 
ğŸ”§ ç„Šæ¥åŸºç¡€        [å®Œæˆç„Šæ¥ç›¸å…³å…³å¡]
ğŸ”§ ç¡¬ä»¶ç»¼åˆ        [å®Œæˆ 3+ ä¸åŒæŠ€èƒ½]

å®æˆ˜ç±»ï¼š
ğŸ† ä»¿çœŸå¤§å¸ˆ        [é€šè¿‡é«˜éš¾åº¦ä»¿çœŸæŒ‘æˆ˜]
ğŸ† åˆ¶é€ è€…          [ä¸Šä¼  1 ä¸ªå®ç‰©è§†é¢‘ï¼Œå¯é€‰]
ğŸ† åˆ›æ–°è€…          [ä¸Šä¼  1 ä¸ªæ”¹è¿›ä½œå“è§†é¢‘ï¼Œå¯é€‰]

ç¤¾åŒºç±»ï¼š
ğŸ‘¥ å¸®åŠ©è€…          [é‡‡çº³ç­”æ¡ˆ 20+ ä¸ª]
ğŸ‘¥ è´¡çŒ®è€…          [å‘è¡¨ 3+ é«˜è´¨é‡æ–‡ç« ]
```

## ğŸ¨ ç”¨æˆ·è®¤è¯é¡µé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æˆ‘çš„å­¦ä¹ è¯ä¹¦                                                â”‚
â”‚                                                                â”‚
â”‚ ğŸ‘¤ æä¸‰ (Level 8)                    [ä¸‹è½½è¯ä¹¦PDF]            â”‚
â”‚ @li_learner                                                    â”‚
â”‚                                                                â”‚
â”‚ ğŸ“Š å·²è·å¾—ï¼š4 ä¸ªå¾½ç«     |  ğŸ¯ è¿›è¡Œä¸­ï¼š2 ä¸ª    |  ğŸ“š å®Œæˆï¼š12 å…³å¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·¦ä¾§ï¼šå¾½ç« å±•ç¤º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–ï¸ æˆ‘çš„å¾½ç«  (4/8)          â”‚
â”‚                              â”‚
â”‚ âœ… å·²è·å¾—ï¼š                  â”‚
â”‚ ğŸ”§ Arduino å…¥é—¨  â­          â”‚
â”‚ ğŸ‘¥ å¸®åŠ©è€…       â­           â”‚
â”‚ ğŸ† ä»¿çœŸå¤§å¸ˆ     â­â­         â”‚
â”‚                              â”‚
â”‚ â³ è¿›è¡Œä¸­ï¼š                  â”‚
â”‚ ğŸ”§ PCB è®¾è®¡å…¥é—¨  2/3 å…³å¡    â”‚
â”‚ ğŸ‘¥ è´¡çŒ®è€…       1/3 æ–‡ç«      â”‚
â”‚                              â”‚
â”‚ [æŸ¥çœ‹æ‰€æœ‰å¾½ç« ]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å³ä¾§ï¼šè¯ä¹¦å’Œåˆ†äº«
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“œ ç”Ÿæˆå­¦ä¹ è¯ä¹¦                        â”‚
â”‚                                        â”‚
â”‚ é€‰æ‹©è¯ä¹¦æ ·å¼ï¼š                         â”‚
â”‚ â¦¿ ç®€çº¦ç‰ˆï¼ˆå…è´¹ï¼‰                      â”‚
â”‚ â¦¿ ç²¾ç¾ç‰ˆï¼ˆPro ä¼šå‘˜ï¼‰                  â”‚
â”‚ â¦¿ å®šåˆ¶ç‰ˆï¼ˆ$9.99ï¼‰                     â”‚
â”‚                                        â”‚
â”‚ [é¢„è§ˆè¯ä¹¦] [ä¸‹è½½ PDF] [åˆ†äº«é“¾æ¥]      â”‚
â”‚                                        â”‚
â”‚ è¯ä¹¦éªŒè¯é“¾æ¥ï¼š                         â”‚
â”‚ knzn.net/cert/abc123                   â”‚
â”‚ [å¤åˆ¶é“¾æ¥]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®ï¼š                        â”‚
â”‚                                        â”‚
â”‚ ğŸ“Œ å®Œæˆ 1 ä¸ªå…³å¡å³å¯è·å¾— PCB è®¾è®¡å¾½ç«   â”‚
â”‚    [ç»§ç»­å­¦ä¹ ]                         â”‚
â”‚                                        â”‚
â”‚ ğŸ“Œ æŒ‘æˆ˜é«˜éš¾åº¦ä»¿çœŸè·å¾—å®æˆ˜è®¤è¯          â”‚
â”‚    [å¼€å§‹æŒ‘æˆ˜]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 1. è¯ä¹¦ç”Ÿæˆå™¨

```javascript
// ä½¿ç”¨ html2canvas + jspdf ç”Ÿæˆè¯ä¹¦
const generateCertificate = (userData, badgeData) => {
  const template = `
    <div class="certificate-template">
      <div class="header">KNZN å­¦ä¹ è¯ä¹¦</div>
      <div class="user-name">${userData.name}</div>
      <div class="achievement">
        å·²å®Œæˆ ${badgeData.skillName} ç›¸å…³å­¦ä¹ 
      </div>
      <div class="skills">
        æŒæ¡æŠ€èƒ½ï¼š${badgeData.skills.join(', ')}
      </div>
      <div class="date">é¢å‘æ—¥æœŸï¼š${new Date().toLocaleDateString()}</div>
      <div class="verify-url">
        éªŒè¯é“¾æ¥ï¼šknzn.net/cert/${generateUniqueId()}
      </div>
    </div>
  `;
  
  // è½¬æ¢ä¸º PDF
  return html2pdf(template);
};
```

### LinkedIn è®¤è¯é›†æˆï¼ˆæµ·å¤–æ ¸å¿ƒåŠŸèƒ½ï¼‰

```javascript
// LinkedIn è¯ä¹¦é›†æˆ API
const LINKEDIN_INTEGRATION = {
  // LinkedIn Learning Certificate API
  certificateAPI: {
    enabled: true,
    
    // æ·»åŠ è¯ä¹¦åˆ° LinkedIn Profile
    addToProfile: async (certificateData) => {
      const linkedinData = {
        name: `KNZN ${certificateData.badgeType} Certification`,
        organization: 'KNZN Hardware Learning Platform',
        issueDate: certificateData.issuedAt,
        credentialId: certificateData.id,
        credentialUrl: `https://knzn.net/c/${certificateData.id}`,
        
        // æŠ€èƒ½æ ‡ç­¾ï¼ˆLinkedIn ä¼šè‡ªåŠ¨è¯†åˆ«ï¼‰
        skills: getSkillsFromBadge(certificateData.badgeType)
      }
      
      // ç”Ÿæˆ LinkedIn åˆ†äº«é“¾æ¥
      const shareUrl = `https://www.linkedin.com/profile/add?startTask=CERTIFICATION_NAME&name=${encodeURIComponent(linkedinData.name)}&organizationName=${encodeURIComponent(linkedinData.organization)}&issueYear=${new Date(linkedinData.issueDate).getFullYear()}&issueMonth=${new Date(linkedinData.issueDate).getMonth() + 1}&certUrl=${encodeURIComponent(linkedinData.credentialUrl)}&certId=${linkedinData.credentialId}`
      
      return shareUrl
    }
  },
  
  // æŠ€èƒ½æ˜ å°„
  skillMapping: {
    'arduino-beginner': ['Arduino', 'Embedded Systems', 'IoT', 'C++', 'Hardware Programming'],
    'pcb-beginner': ['PCB Design', 'Electronic Design', 'Circuit Design', 'Hardware Engineering'],
    'helper': ['Technical Mentoring', 'Community Building', 'Knowledge Sharing'],
    'simulation-master': ['Circuit Simulation', 'Wokwi', 'Virtual Prototyping']
  },
  
  // è¯ä¹¦æè¿°æ¨¡æ¿
  descriptionTemplates: {
    'arduino-beginner': 'Completed comprehensive Arduino programming course including GPIO control, sensor integration, and embedded systems fundamentals.',
    'pcb-beginner': 'Mastered PCB design principles, component selection, and circuit layout optimization through hands-on projects.',
    'helper': 'Demonstrated expertise in technical mentoring by providing high-quality answers and guidance to community members.',
    'simulation-master': 'Achieved mastery in circuit simulation and virtual prototyping using advanced simulation tools.'
  }
}

// å‰ç«¯ LinkedIn åˆ†äº«ç»„ä»¶
// components/LinkedInCertificateShare.vue
<template>
  <div class="linkedin-share">
    <h3>ğŸ“ Add to LinkedIn Profile</h3>
    <p>Showcase your achievement to professional network</p>
    
    <div class="certificate-preview">
      <div class="cert-info">
        <h4>{{ certificateName }}</h4>
        <p>Issued by KNZN Hardware Learning Platform</p>
        <p>Credential ID: {{ certificateId }}</p>
      </div>
      
      <div class="skills-tags">
        <span v-for="skill in skills" :key="skill" class="skill-tag">
          {{ skill }}
        </span>
      </div>
    </div>
    
    <div class="share-actions">
      <button @click="addToLinkedIn" class="linkedin-btn">
        <LinkedInIcon />
        Add to LinkedIn Profile
      </button>
      
      <button @click="copyCredentialUrl" class="copy-btn">
        ğŸ“‹ Copy Credential URL
      </button>
    </div>
    
    <div class="pro-upgrade" v-if="!isProUser">
      <p>ğŸ’ LinkedIn integration is a Pro feature</p>
      <button @click="upgradeToPro">Upgrade to Pro</button>
    </div>
  </div>
</template>

<script setup>
const props = defineProps(['certificateId', 'badgeType'])

const certificateName = computed(() => {
  return LINKEDIN_INTEGRATION.descriptionTemplates[props.badgeType] || 'KNZN Hardware Learning Certificate'
})

const skills = computed(() => {
  return LINKEDIN_INTEGRATION.skillMapping[props.badgeType] || []
})

const addToLinkedIn = async () => {
  if (!isProUser.value) {
    showUpgradeModal()
    return
  }
  
  try {
    const shareUrl = await LINKEDIN_INTEGRATION.certificateAPI.addToProfile({
      id: props.certificateId,
      badgeType: props.badgeType,
      issuedAt: new Date()
    })
    
    // åœ¨æ–°çª—å£æ‰“å¼€ LinkedIn
    window.open(shareUrl, '_blank', 'width=600,height=600')
    
    // è®°å½•åˆ†äº«äº‹ä»¶
    await $fetch('/api/analytics/certificate-shared', {
      method: 'POST',
      body: {
        certificateId: props.certificateId,
        platform: 'linkedin'
      }
    })
    
  } catch (error) {
    console.error('LinkedIn sharing failed:', error)
    showErrorMessage('Failed to share to LinkedIn')
  }
}

const copyCredentialUrl = () => {
  const url = `https://knzn.net/c/${props.certificateId}`
  navigator.clipboard.writeText(url)
  showSuccessMessage('Credential URL copied to clipboard')
}
</script>
```

```javascript
// è‡ªåŠ¨æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ»¡è¶³å¾½ç« æ¡ä»¶
// server/api/badges/check.post.ts
export default defineEventHandler(async (event) => {
  const session = await getUserSession(event)
  if (!session) {
    throw createError({ statusCode: 401, statusMessage: 'Unauthorized' })
  }
  
  const userId = session.user.id
  const newBadges = []
  
  // è·å–ç”¨æˆ·è¿›åº¦
  const userProgress = await db.select()
    .from(progress)
    .where(eq(progress.userId, userId))
  
  const completedLessons = userProgress.filter(p => p.status === 'completed')
  
  // Arduino å…¥é—¨å¾½ç« 
  const arduinoLessons = completedLessons.filter(p => p.lessonId.startsWith('arduino'))
  if (arduinoLessons.length >= 3) {
    const hasArduinoBadge = await checkUserHasBadge(userId, 'arduino-beginner')
    if (!hasArduinoBadge) {
      await awardBadge(userId, 'arduino-beginner')
      newBadges.push('arduino-beginner')
    }
  }
  
  // PCB è®¾è®¡å¾½ç«   
  const pcbLessons = completedLessons.filter(p => p.lessonId.startsWith('pcb'))
  if (pcbLessons.length >= 3) {
    const hasPcbBadge = await checkUserHasBadge(userId, 'pcb-beginner')
    if (!hasPcbBadge) {
      await awardBadge(userId, 'pcb-beginner')
      newBadges.push('pcb-beginner')
    }
  }
  
  // å¸®åŠ©è€…å¾½ç« 
  const acceptedAnswers = await db.select()
    .from(replies)
    .where(
      and(
        eq(replies.userId, userId),
        eq(replies.isBestAnswer, true)
      )
    )
  
  if (acceptedAnswers.length >= 20) {
    const hasHelperBadge = await checkUserHasBadge(userId, 'helper')
    if (!hasHelperBadge) {
      await awardBadge(userId, 'helper')
      newBadges.push('helper')
    }
  }
  
  return {
    newBadges,
    message: newBadges.length > 0 ? 'æ­å–œè·å¾—æ–°å¾½ç« ï¼' : 'æš‚æ— æ–°å¾½ç« '
  }
})

// ğŸ›¡ï¸ é˜²ä½œå¼Šæœºåˆ¶
const ANTI_CHEAT_SYSTEM = {
  // å…³é”®åˆ¤é¢˜é€»è¾‘æ”¾åœ¨åç«¯
  serverSideValidation: {
    enabled: true,
    
    // åœ¨æœåŠ¡ç«¯é‡æ–°éªŒè¯æŒ‘æˆ˜ç»“æœ
    validateChallenge: async (userId, challengeId, submissionData) => {
      // éªŒè¯æäº¤æ•°æ®çš„å®Œæ•´æ€§
      const dataIntegrity = verifySubmissionIntegrity(submissionData)
      if (!dataIntegrity) {
        return { isValid: false, reason: 'Data integrity check failed' }
      }
      
      // æ£€æŸ¥æ—¶é—´åˆç†æ€§ï¼ˆé˜²æ­¢ç¬é—´å®Œæˆï¼‰
      const timeValidation = validateCompletionTime(submissionData.timeSpent)
      if (!timeValidation) {
        return { isValid: false, reason: 'Completion time suspicious' }
      }
      
      // é‡æ–°è¿è¡Œæµ‹è¯•ç”¨ä¾‹
      const testResults = await runServerSideTests(challengeId, submissionData.code)
      
      return {
        isValid: testResults.passed,
        score: testResults.score,
        evidence: testResults.evidence
      }
    }
  },
  
  // å‰ç«¯æ•°æ®ç­¾å
  dataIntegrity: {
    enabled: true,
    
    // å¯¹å…³é”®æ•°æ®è¿›è¡Œç­¾å
    signCriticalData: (data) => {
      const timestamp = Date.now()
      const payload = { ...data, timestamp }
      const signature = generateHMAC(payload, process.env.SIGNING_KEY)
      
      return { payload, signature }
    }
  },
  
  // è¡Œä¸ºåˆ†æ
  behaviorAnalysis: {
    enabled: true,
    
    // æ£€æµ‹å¼‚å¸¸è¡Œä¸ºæ¨¡å¼
    detectAnomalies: (userActions) => {
      const flags = []
      
      // å®Œæˆæ—¶é—´è¿‡çŸ­
      if (userActions.completionTime < 30000) { // 30ç§’
        flags.push('suspiciously_fast')
      }
      
      // é¼ æ ‡/é”®ç›˜æ´»åŠ¨å¼‚å¸¸
      if (userActions.interactionCount < 10) {
        flags.push('insufficient_interaction')
      }
      
      // ä»£ç ä¿®æ”¹æ¬¡æ•°å¼‚å¸¸
      if (userActions.codeChanges < 3) {
        flags.push('minimal_code_changes')
      }
      
      return flags
    }
  }
}

// å¾½ç« é¢å‘å‡½æ•°ï¼ˆä½¿ç”¨çŸ­ ID + é‡è¯•æœºåˆ¶ï¼‰
import { nanoid } from 'nanoid'

async function awardBadge(userId: string, badgeType: string) {
  let certificateId: string
  let attempts = 0
  const maxAttempts = 3
  
  // ğŸ›¡ï¸ é‡è¯•æœºåˆ¶ï¼šé˜²æ­¢ nanoid å†²çªï¼ˆè™½ç„¶æ¦‚ç‡æä½ï¼‰
  while (attempts < maxAttempts) {
    try {
      certificateId = nanoid(8) // ç”Ÿæˆ 8 ä½çŸ­ IDï¼Œå¦‚ 'Xy9AzP2k'
      const verifyHash = generateVerifyHash(userId, badgeType, certificateId)
      
      await db.insert(certificates).values({
        id: certificateId, // çŸ­ ID è€Œéé•¿ UUID
        userId,
        badgeType,
        verifyHash,
        issuedAt: new Date()
      })
      
      // æ’å…¥æˆåŠŸï¼Œè·³å‡ºå¾ªç¯
      break
      
    } catch (error) {
      attempts++
      
      // æ£€æŸ¥æ˜¯å¦æ˜¯å”¯ä¸€æ€§çº¦æŸé”™è¯¯
      if (error.code === '23505' && error.constraint?.includes('certificates_pkey')) {
        console.warn(`Certificate ID collision detected (attempt ${attempts}/${maxAttempts}):`, certificateId)
        
        if (attempts >= maxAttempts) {
          // æœ€åä¸€æ¬¡å°è¯•å¤±è´¥ï¼Œä½¿ç”¨æ›´é•¿çš„ ID
          certificateId = nanoid(12) // é™çº§åˆ° 12 ä½
          const verifyHash = generateVerifyHash(userId, badgeType, certificateId)
          
          await db.insert(certificates).values({
            id: certificateId,
            userId,
            badgeType,
            verifyHash,
            issuedAt: new Date()
          })
          
          console.warn('Used 12-character fallback ID:', certificateId)
          break
        }
        
        // ç»§ç»­é‡è¯•
        continue
      } else {
        // å…¶ä»–é”™è¯¯ï¼Œç›´æ¥æŠ›å‡º
        throw error
      }
    }
  }
  
  // æ›´æ–°ç”¨æˆ·å¾½ç« åˆ—è¡¨
  const user = await db.select().from(users).where(eq(users.id, userId)).limit(1)
  if (user.length) {
    const currentBadges = user[0].badges || []
    await db.update(users)
      .set({ 
        badges: [...currentBadges, badgeType]
      })
      .where(eq(users.id, userId))
  }
  
  return certificateId
}

// è¯ä¹¦éªŒè¯é¡µé¢ï¼ˆå¢åŠ é”™è¯¯å¤„ç†ï¼‰
// server/api/cert/[id].get.ts
export default defineEventHandler(async (event) => {
  const certificateId = getRouterParam(event, 'id') // çŸ­ ID
  
  // ğŸ›¡ï¸ è¾“å…¥éªŒè¯ï¼šç¡®ä¿ ID æ ¼å¼æ­£ç¡®
  if (!certificateId || !/^[A-Za-z0-9_-]{8,12}$/.test(certificateId)) {
    throw createError({
      statusCode: 400,
      statusMessage: 'Invalid certificate ID format'
    })
  }
  
  try {
    const certificate = await db.select({
      id: certificates.id,
      badgeType: certificates.badgeType,
      issuedAt: certificates.issuedAt,
      verifyHash: certificates.verifyHash,
      userName: users.name,
      userLevel: users.level
    })
    .from(certificates)
    .leftJoin(users, eq(certificates.userId, users.id))
    .where(eq(certificates.id, certificateId))
    .limit(1)
    
    if (!certificate.length) {
      throw createError({
        statusCode: 404,
        statusMessage: 'Certificate not found'
      })
    }
    
    return {
      certificate: certificate[0],
      verifyUrl: `https://knzn.net/c/${certificateId}`, // çŸ­é“¾æ¥æ ¼å¼
      isValid: true,
      verifiedAt: new Date().toISOString()
    }
    
  } catch (error) {
    console.error('Certificate verification error:', error)
    throw createError({
      statusCode: 500,
      statusMessage: 'Certificate verification failed'
    })
  }
})

// å‰ç«¯è¯ä¹¦å±•ç¤º
const CertificateDisplay = ({ certificateId }) => {
  return (
    <div className="certificate">
      <h2>KNZN å­¦ä¹ è¯ä¹¦</h2>
      <p>è¯ä¹¦ç¼–å·ï¼š{certificateId}</p>
      <p>éªŒè¯é“¾æ¥ï¼šknzn.net/c/{certificateId}</p>
      <div className="qr-code">
        <QRCode value={`https://knzn.net/c/${certificateId}`} />
      </div>
    </div>
  )
}

// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²æœ‰å¾½ç« 
async function checkUserHasBadge(userId: string, badgeType: string) {
  const existing = await db.select()
    .from(certificates)
    .where(
      and(
        eq(certificates.userId, userId),
        eq(certificates.badgeType, badgeType)
      )
    )
    .limit(1)
  
  return existing.length > 0
}
```

## ğŸ’° å˜ç°æ¨¡å¼ï¼ˆæµ·å¤–å¸‚åœºç‰ˆï¼‰

### è¯ä¹¦ç›¸å…³æ”¶è´¹

```
ğŸ“œ è¯ä¹¦æœåŠ¡
â”œâ”€ ç”µå­ç‰ˆè¯ä¹¦ï¼šå…è´¹
â”œâ”€ é«˜æ¸… PDF ä¸‹è½½ï¼šPro ä¼šå‘˜ï¼ˆ$9.99/æœˆï¼‰
â”œâ”€ å®šåˆ¶è¯ä¹¦æ ·å¼ï¼š$9.99/æ¬¡
â””â”€ LinkedIn è®¤è¯å±•ç¤ºï¼šPro ä¼šå‘˜åŠŸèƒ½ â­ æµ·å¤–æ ¸å¿ƒåŠŸèƒ½

ğŸ–ï¸ å¾½ç« å±•ç¤º
â”œâ”€ åŸºç¡€å¾½ç« ï¼šå…è´¹
â”œâ”€ é‡‘è¾¹ç‰¹æ•ˆå¾½ç« ï¼šPro ä¼šå‘˜
â”œâ”€ ä¸ªäººä¸»é¡µå¾½ç« å¢™ï¼šPro ä¼šå‘˜
â”œâ”€ å¾½ç« åˆ†äº«å¡ç‰‡ï¼šPro ä¼šå‘˜
â””â”€ LinkedIn æŠ€èƒ½è®¤è¯ï¼šPro ä¼šå‘˜ â­ æµ·å¤–é‡ç‚¹

ğŸ“Š æ•°æ®æœåŠ¡  
â”œâ”€ å­¦ä¹ è¿›åº¦æŠ¥å‘Šï¼šPro ä¼šå‘˜
â”œâ”€ æŠ€èƒ½é›·è¾¾å›¾ï¼šPro ä¼šå‘˜
â”œâ”€ å¹´åº¦å­¦ä¹ æ€»ç»“ï¼šPro ä¼šå‘˜
â””â”€ èŒä¸šå‘å±•å»ºè®®ï¼šPro ä¼šå‘˜ â­ æµ·å¤–æ–°å¢
```

### é¢„æœŸæ”¶å…¥ï¼ˆæµ·å¤–å¸‚åœºï¼‰

```
æœˆåº¦æ”¶å…¥é¢„ä¼°ï¼š
â”œâ”€ Pro ä¼šå‘˜ï¼š100 äºº Ã— $9.99 = $999
â”œâ”€ å®šåˆ¶è¯ä¹¦ï¼š20 æ¬¡ Ã— $9.99 = $199.8  
â””â”€ æ€»è®¡ï¼šçº¦ $1,200/æœˆ

æˆæœ¬ï¼š
â”œâ”€ æœåŠ¡å™¨ï¼š$50/æœˆ
â”œâ”€ äººå·¥å®¡æ ¸ï¼š$200/æœˆï¼ˆæ¯å¤© 10 åˆ†é’Ÿï¼‰
â””â”€ å‡€åˆ©æ¶¦ï¼š$950/æœˆ

å¹´æ”¶å…¥é¢„ä¼°ï¼š$11,400 - $14,400
```

## ğŸš€ MVP å¼€å‘è®¡åˆ’

### Week 1: æ ¸å¿ƒåŠŸèƒ½
- [ ] å¾½ç« ç³»ç»ŸåŸºç¡€æ¶æ„
- [ ] è‡ªåŠ¨è®¤è¯é€»è¾‘
- [ ] ç”¨æˆ·è®¤è¯é¡µé¢

### Week 2: è¯ä¹¦ç”Ÿæˆ
- [ ] è¯ä¹¦æ¨¡æ¿è®¾è®¡
- [ ] PDF ç”ŸæˆåŠŸèƒ½
- [ ] è¯ä¹¦éªŒè¯é¡µé¢

### Week 3: é«˜éš¾åº¦æŒ‘æˆ˜
- [ ] ä»¿çœŸæŒ‘æˆ˜ç³»ç»Ÿ
- [ ] é˜²ä½œå¼Šæœºåˆ¶
- [ ] è‡ªåŠ¨è¯„åˆ†é€»è¾‘

### Week 4: å˜ç°åŠŸèƒ½
- [ ] Pro ä¼šå‘˜ç³»ç»Ÿ
- [ ] ä»˜è´¹è¯ä¹¦æ ·å¼
- [ ] æ”¯ä»˜é›†æˆ

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | è¯´æ˜ |
|------|------|------|
| **å¾½ç« è·å¾—ç‡** | 40% | ç”¨æˆ·è·å¾—è‡³å°‘ 1 ä¸ªå¾½ç« çš„æ¯”ä¾‹ |
| **è¯ä¹¦ä¸‹è½½ç‡** | 20% | è·å¾—å¾½ç« ç”¨æˆ·ä¸‹è½½è¯ä¹¦çš„æ¯”ä¾‹ |
| **Pro è½¬åŒ–ç‡** | 5% | å…è´¹ç”¨æˆ·è½¬ä¸º Pro ä¼šå‘˜çš„æ¯”ä¾‹ |
| **æŒ‘æˆ˜é€šè¿‡ç‡** | 15% | é«˜éš¾åº¦ä»¿çœŸæŒ‘æˆ˜çš„é€šè¿‡ç‡ |
| **å®¡æ ¸æ•ˆç‡** | 10 åˆ†é’Ÿ/å¤© | æ¯æ—¥è§†é¢‘å®¡æ ¸æ—¶é—´ |
| **ç”¨æˆ·æ»¡æ„åº¦** | 4.0+ â­ | å¯¹è®¤è¯ç³»ç»Ÿçš„æ»¡æ„åº¦ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**ç¼–åˆ¶æ—¶é—´**: 2024-12-22  
**å®¡æ ¸çŠ¶æ€**: âœ… æœ€ç»ˆç¡®å®šç‰ˆæœ¬  
**äº¤ä»˜å¯¹è±¡**: å¼€å‘å›¢é˜Ÿ