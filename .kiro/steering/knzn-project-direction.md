# KNZN 项目整体方向指导

## 项目核心理念

**KNZN 硬件学习平台** 是一个面向全球开发者的硬件学习平台，采用 Nuxt 4 + PostgreSQL + Docker 容器化部署架构，专注于通过 Wokwi 仿真器集成和游戏化学习提供沉浸式的硬件学习体验。

### 核心价值主张
- **云端硬件实验室**: 无需实体硬件即可进行完整的硬件学习
- **游戏化学习体验**: 通过技能地图、成就系统、证书认证激发学习动力
- **海外市场优先**: GDPR 合规、Email 优先认证、全球化部署
- **个人开发者友好**: 优化的技术栈选择，控制开发和运维成本

## 技术架构原则

### 核心技术栈
- **前端框架**: Nuxt 4 (Vue 3 + TypeScript)
- **数据库**: PostgreSQL + Drizzle ORM
- **认证系统**: Better-Auth (支持 OAuth + Magic Link)
- **邮件服务**: Resend (海外市场优化)
- **支付系统**: Lemon Squeezy (全球税务自动化)
- **部署方案**: Contabo VPS + Docker 容器化

### 设计决策原则
1. **实用主义优先**: 选择成熟稳定的技术方案，避免过度工程化
2. **开发效率**: 优先使用 Nuxt 模块和自动化工具，减少重复开发
3. **成本控制**: 月运维成本控制在 $75 以内，适合个人开发者
4. **海外适配**: 所有功能设计都考虑海外用户习惯和法规要求

## 开发阶段规划

### Phase 1: 基础架构 (Week 1-4)
**核心目标**: 建立稳定的技术基础和用户认证体系

**关键 Specs**:
- Spec 1: 项目基础架构搭建 (Nuxt 4 + PostgreSQL + Docker)
- Spec 2: 用户认证系统 (Better-Auth + OAuth)
- Spec 3: 邮件服务系统 (Resend 集成)

**验收标准**: 用户可以注册、登录，收到欢迎邮件

### Phase 2: 核心用户界面 (Week 5-8)
**核心目标**: 建立独特的用户体验和品牌认知

**关键 Specs**:
- Spec 4: 首页闸刀交互系统 (序列帧动画 + 通电仪式)
- Spec 5: 技能地图 SVG 系统 (30个节点 + 4个扇区)
- Spec 6: 用户中心页面 (Dashboard + 成就系统)

**验收标准**: 用户完成通电仪式，浏览技能地图，查看个人进度

### Phase 3: 核心学习功能 (Week 9-12)
**核心目标**: 实现核心的硬件学习体验

**关键 Specs**:
- Spec 7: Wokwi 仿真器集成 (iframe + postMessage 通信)
- Spec 8: 关卡场景系统 (四阶段学习流程 + 判题系统)

**验收标准**: 用户可以完成完整的硬件学习关卡

### Phase 4: 商业化功能 (Week 13-16)
**核心目标**: 建立可持续的商业模式

**关键 Specs**:
- Spec 9: 支付系统 (Lemon Squeezy + Pro 订阅)
- Spec 10: 蓝图库系统 (联盟营销 + BOM 清单)
- Spec 11: 证书系统 (PDF 生成 + LinkedIn 集成)

**验收标准**: 用户可以升级 Pro，下载蓝图，获得技能证书

### Phase 5: 社区与管理 (Week 17-20)
**核心目标**: 支持规模化运营和用户社区

**关键 Specs**:
- Spec 12: 社区中心 (轻社交 + Wokwi 项目分享)
- Spec 13: 管理后台 (用户管理 + 内容审核)
- Spec 14: 数据备份与监控 (自动备份 + 性能监控)

**验收标准**: 平台可以稳定运行，支持用户社区互动

## MVP 发布策略

### MVP 1.0 (Week 8) - 核心体验验证
**包含功能**: 首页交互 + 技能地图 + 用户中心 + 认证系统
**验证目标**: 
- 用户注册转化率 > 15%
- 首页通电完成率 > 80%
- 7天留存率 > 40%

### MVP 1.5 (Week 12) - 学习功能验证
**包含功能**: + Wokwi 集成 + 关卡系统
**验证目标**:
- 关卡完成率 > 70%
- Wokwi 加载成功率 > 95%
- 用户学习时长 > 15分钟/会话

### MVP 2.0 (Week 16) - 商业化验证
**包含功能**: + 支付系统 + 蓝图库 + 证书系统
**验证目标**:
- Pro 转化率 > 5%
- 月收入 > $1,000
- 证书生成率 > 50%

### MVP 2.5 (Week 20) - 完整产品
**包含功能**: + 社区中心 + 管理后台 + 监控系统
**最终目标**:
- 月活跃用户 > 1,000
- 月收入 > $5,000
- 系统可用性 > 99.9%

## 关键技术决策

### 1. 为什么选择 Nuxt 4 而不是 Next.js？
- **Vue 生态更适合个人开发者**: 学习曲线平缓，开发效率高
- **SSR 性能优势**: Nitro 引擎在容器环境下冷启动更快
- **自动化程度高**: 自动路由和 API 生成，减少配置工作

### 2. 为什么选择 SVG 技能地图而不是 Canvas？
- **开发效率**: Canvas 3-4周 vs SVG 6-9天
- **维护成本**: SVG 静态布局 vs Canvas 复杂物理仿真
- **无障碍支持**: SVG 原生 DOM 支持 vs Canvas 需要额外适配层
- **跨设备兼容**: SVG 自动缩放 vs Canvas 需要大量适配测试

### 3. 为什么选择 Better-Auth 而不是 NextAuth？
- **海外市场需求**: 原生支持 Magic Link，海外用户偏好
- **GDPR 合规**: 内置数据导出和删除功能
- **容器化友好**: 相比 Supabase Auth 更适合 VPS 自托管
- **邮件优先**: 完全不依赖手机号，符合海外用户习惯

### 4. 为什么选择 Lemon Squeezy 而不是 Stripe？
- **税务自动化**: 自动处理全球 VAT 和美国各州税法
- **合规简化**: 内置 GDPR/CCPA 合规处理
- **个人开发者友好**: 无需复杂的商户认证流程
- **成本透明**: 5% + $0.50 固定费率，无隐藏费用

## 开发指导原则

### 代码质量要求
1. **TypeScript 严格模式**: 所有代码必须通过严格类型检查
2. **组件规范**: 使用 `<script setup lang="ts">` 语法，Props 使用泛型定义
3. **SSR 兼容**: Wokwi 等浏览器依赖组件必须使用 `<ClientOnly>` 包装
4. **样式规范**: 使用 UnoCSS 主题变量，禁止硬编码颜色值

### 性能要求
1. **页面加载时间** < 2s
2. **API 响应时间** < 500ms
3. **Wokwi 集成稳定性** > 95%
4. **移动端适配**: 桌面优先，移动端引导到桌面

### 安全要求
1. **认证安全**: 使用 Better-Auth 的安全最佳实践
2. **数据保护**: 符合 GDPR 要求，支持数据导出和删除
3. **API 安全**: 所有 API 输入使用 Zod 验证
4. **环境变量**: 使用 @t3-oss/env-nuxt 进行强类型验证

## 风险管控

### 技术风险
1. **Wokwi API 稳定性**: 提前进行 PoC 验证，准备降级方案
2. **iframe 通信性能**: 性能测试，优化通信频率
3. **移动端适配复杂度**: 采用桌面优先策略

### 商业风险
1. **Wokwi 商业授权**: 提前咨询商业政策，准备替代方案
2. **海外支付合规**: 使用 Lemon Squeezy 自动处理税务合规

### 运营风险
1. **内容审核**: 建立社区规则和自动化审核机制
2. **客服支持**: 建立 FAQ 和工单系统
3. **数据备份**: 自动化备份到 Cloudflare R2

## 成功指标

### 用户指标
- **月活跃用户**: > 1,000
- **7天留存率**: > 60%
- **关卡完成率**: > 70%
- **用户学习时长**: > 15分钟/会话

### 商业指标
- **Pro 转化率**: > 5%
- **月收入**: > $5,000
- **用户获取成本**: < $10
- **客户生命周期价值**: > $50

### 技术指标
- **系统可用性**: > 99.9%
- **页面加载时间**: < 2s
- **API 响应时间**: < 500ms
- **Wokwi 集成稳定性**: > 95%

## 开发团队指导

### 开发前准备
1. **必读文档**: 阅读对应的设计文档，理解功能需求和设计理念
2. **技术准备**: 参考全栈开发指导搭建开发环境
3. **架构理解**: 学习项目架构文档了解系统架构

### 开发过程中
1. **需求确认**: 每个 Spec 都有明确的设计依据，遇到疑问时回查原始设计文档
2. **技术决策**: 理解每个技术选择的原因，避免盲目开发
3. **验收标准**: 严格按照验收标准进行自测，确保质量

### MVP 迭代策略
1. **快速验证**: 优先开发 MVP 1.0，快速验证核心假设
2. **数据驱动**: 基于用户反馈和数据分析决定后续功能优先级
3. **持续优化**: 每个 MVP 版本都要收集用户反馈，持续改进

## 文档依据

本指导基于以下核心文档制定：

### 架构设计文档
- `KNZN 个人开发者技术栈白皮书.md` - 技术选型原则和架构设计
- `KNZN 项目架构与部署方案文档.md` - 系统架构和部署策略
- `newDocs/01-knzn-fullstack-development-guide.md` - 全栈开发实现指导

### 功能设计文档
- `docs/KNZN-首页设计文档-v1.3.1.md` - 首页闸刀交互系统设计
- `docs/KNZN-技能地图设计文档-SVG简化版.md` - 技能地图 SVG 实现方案
- `docs/KNZN 关卡场景页面设计文档.md` - 关卡系统和 Wokwi 集成设计
- `docs/KNZN 用户中心页面设计文档.md` - 用户中心和成就系统设计
- 以及其他相关设计文档

### 业务指导文档
- `newDocs/02-knzn-core-interaction-guide.md` - 核心交互和仿真集成
- `newDocs/03-knzn-infrastructure-ops-guide.md` - 基础设施和运维指导
- `newDocs/04-knzn-business-compliance-guide.md` - 商业化和合规要求

---

**使用说明**: 本文档作为 KNZN 项目的整体方向指导，所有开发决策都应该参考这些原则和目标。在开发过程中如有疑问，请回查相关的设计文档和技术指导文档。